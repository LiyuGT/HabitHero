<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='styles.css') }}">
</head>

<body>
        <div class="navbar">
            <a href="{{url_for('home')}}">Home</a>
            <a href="">My Habits</a>
            <h1>Habit Hero</h1>
            <a href="">Habitats</a>
            <a href="{{url_for('logout')}}">Logout</a>
            <img id="profilePicture" alt="profile picture" src="static/images/flame_colored.png">
        </div>
    <main>

        <!-- <div class="popup" id="popup">
<div class="popup-content">
    <span class="close" id="closePopupButton">&times;</span>
    <h1>Create Habit</h1>

  <form method="POST" id="/habits">
    {{form.title.label}} {{form.title}}
    {{form.submit}}

  </form>
</div> -->

        <button class="open-button" onclick="openForm()">Create Habit</button>

        <!-- <label for="email"><b>Habit Name</b></label>
    <input type="text" placeholder="Enter Email" name="email" required>

    <label for="psw"><b>Password</b></label>
    <input type="password" placeholder="Enter Password" name="psw" required> -->
        <!-- The form -->
        <div class="form-popup" id="myForm">
            <form method="POST" action="/habits" class="form-container">
                <h1>Create Habit</h1>

                {{form.title.label}} {{form.title}}

                <button type="submit" class="btn">Create Habit</button>

                <button type="button" class="btn cancel" onclick="closeForm()">Close</button>
            </form>
        </div>

        <!-- Hardcoded habit for reference -->
        <!-- <div class="habitItem">
            <button><img src="static/images/unchecked.png"></button>
            <p>Drink water</p>
            <div class="spacer"></div>
            <div class="streak">
                <p>10</p>
                <img src="static/images/flame_grayscale.png">
            </div>
        </div>

        <div class="habitItem checkedOff">
            <button><img src="static/images/checkmark.png"></button>
            <p>Drink water</p>
            <div class="spacer"></div>
            <div class="streak">
                <p>10</p>
                <img src="static/images/flame_colored.png">
            </div>
        </div> -->

        {% for habit in habits %}

        <div class="habitItem">
            <button>
                {% if habit.done %}
                <img src="static/images/checkmark.png">
                {% else %}
                <img src="static/images/unchecked.png">
                {% endif %}
            </button>

            <p>{{ habit.title }}</p>
            <div class="spacer"></div>
            <div class="streak">
                <p>{{ habit.streak }}</p>

                {% if habit.done %}
                <img src="static/images/flame_colored.png">
                {% else %}
                <img src="static/images/flame_grayscale.png">
                {% endif %}

            </div>

            <button type="submit" class="btn" onclick="removeHabit('{{ habit.id }}')">Remove</button>

        </div>

        {% endfor %}

    </main>

    <script>
        function openForm() {
            document.getElementById("myForm").style.display = "block";
        }

        function closeForm() {
            document.getElementById("myForm").style.display = "none";
        }

        function removeHabit(habitId) {
            if (confirm("Are you sure you want to delete this habit?")) {
                fetch(`/habits/${habitId}/delete`, { method: 'POST' })
                    .then(() => location.reload())
                    .catch(error => console.error('Error:', error));
            }
        }

    </script>
</body>

</html>